(this["webpackJsonprre-openKnowledgeworker"]=this["webpackJsonprre-openKnowledgeworker"]||[]).push([[166],{1718:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i(1),n=i(4);const o=e=>Object(a.createSelector)([n.a],t=>{var i,a;return null!==(i=null===(a=t[e])||void 0===a?void 0:a.isLoaded)&&void 0!==i&&i})},1719:function(e,t,i){"use strict";function a(e,t){let i=0;const a=(...a)=>{if(i++,e(...a))return t()(...a)};return a.recomputations=()=>i,a.resetRecomputations=()=>i=0,a.dependencies=[e],a.resultFunc=t(),a}i.d(t,"a",(function(){return a}))},1770:function(e,t,i){e.exports={layeredImageWrapper:"_2OM532RrNXbSHBcmZfz_rc",layer:"ADASaH_PuIc7LQeg6hKZu",layeredImageContent:"_1l0tbB4XVGiR94T5zCd-hB"}},1844:function(e,t,i){e.exports={layerIcon:"_3GID-jPARr0-Y4CI85IK9U",layerIconWrapper:"_1Pi8jPUvAMH-k7G042x6Sj",layerIconContent:"ilZQjy5MeWwW3WDz-dJV9",pulse:"_3hdaGnvUR1YBl13YbBUwzM",loader:"_3SH_92KjE8ZwNa_qDEn1R6"}},1845:function(e,t,i){e.exports={layerIconPlacementWrapper:"_3zHhGaJMszg_M7xFW5SxBw"}},1846:function(e,t,i){e.exports={layerIconWrapper:"_1a8jtLgSE3xauavurZ-NR2",renderedItemContainer:"_3wRbY4ts_Jq53Z2Ho3PhXr"}},1978:function(e,t,i){"use strict";i.r(t),i.d(t,"defaultLayeredImageViewParams",(function(){return Ue})),i.d(t,"layeredImagePlugin",(function(){return Ge}));var a=i(9),n=i(896),o=i(897),r=i(884),l=i(885),s=i(382),d=i(0),c=i.n(d),p=i(2),m=i(88),u=i(166),h=i(1),v=i(1719),g=i(1718),b=i(99),I=i(25);const y={};var O=i(16),j=i(13),C=i(4),T=i(835),E=i(643);const w=Object(h.createSelector)([O.d],e=>{if(Object(E.b)(e))return e}),f=Object(h.createSelector)([w],e=>null===e||void 0===e?void 0:e.state),S=Object(h.createSelector)([C.k],e=>{var t;return null!==(t=e[T.b])&&void 0!==t?t:{}}),k=Object(h.createSelector)([S,j.c],(e,t)=>e[t]);var x=i(167),W=i(941);const A=Object(g.a)(s.b),P=Object(g.a)(l.b),L=Object(g.a)(W.a),M=Object(v.a)(A,()=>{var e;return null===(e=y.titleAndCaption)||void 0===e?void 0:e.selectors.getCaption}),R=Object(v.a)(A,()=>{var e;return null===(e=y.titleAndCaption)||void 0===e?void 0:e.selectors.getTitle}),_=(Object(v.a)(L,()=>{var e;return null===(e=y.altText)||void 0===e?void 0:e.selectors.getAltText}),Object(v.a)(P,()=>{var e;return null===(e=y.mediumAlignment)||void 0===e?void 0:e.selectors.getAlignment})),N=Object(h.createSelector)([b.a,f],(e,t)=>e.filter(I.d).map(e=>{var i,a,n;return{uid:e.uid,mediaobject:null===(i=e.state)||void 0===i?void 0:i.mediaobject,layerName:null===t||void 0===t||null===(a=t.layerNames)||void 0===a||null===(n=a.find(t=>t.uid===e.uid))||void 0===n?void 0:n.html}})),D=Object(h.createSelector)([k],e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.activeItem)&&void 0!==t?t:0}),H=(Object(h.createSelector)([D,x.a],(e,t)=>t[e].uid),Object(h.createSelector)([N,D],(e,t)=>t===e.length-1?0:t+1)),V=Object(h.createSelector)([N,H],(e,t)=>null===e||void 0===e?void 0:e[t].layerName),z=Object(h.createSelector)([f],e=>{var t;return null===(t=null===e||void 0===e?void 0:e.showIcon)||void 0===t||t}),B=Object(h.createSelector)([z,f],(e,t)=>e&&void 0===(null===t||void 0===t?void 0:t.type)),K=Object(h.createSelector)([f],e=>void 0!==(null===e||void 0===e?void 0:e.type)),U=Object(h.createSelector)([k],e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.visitedItems.length)&&void 0!==t?t:0}),G=Object(h.createSelector)([k],e=>null===e||void 0===e?void 0:e.interactionComplete),Z=(Object(h.createSelector)([f],e=>null===e||void 0===e?void 0:e.type),Object(h.createSelector)([f],e=>null===e||void 0===e?void 0:e.type));var J=i(641),X=i(640),Y=i(206),q=i(39),F=i(120),Q=i(7),$=i(488),ee=i(683);const te=(e,t,i,a,n)=>{if(0===e.length)return{width:t,height:9*t/16,ratio:9/16};const o=i?Math.min(i,t):t,r=e.map(({width:e,height:t})=>({width:Object(ee.a)(e,t,void 0,a),height:t}));let l=r.reduce((e,t)=>{var i;return Math.min(e,null!==(i=t.width)&&void 0!==i?i:1/0)},o),s=r.reduce((e,t)=>{if(t.height&&t.width){const i=t.height*(l/t.width);if(i<e)return i}return e},1/0);if(n&&n<s){l*=n/s,s=n}return{width:l,height:s,ratio:s/l}},ie=e=>({type:"@@layeredImage/ACTIVATE_NEXT_ITEM",payload:{uid:e}}),ae=(e,t)=>({type:"@@layeredImage/SET_ACTIVE_ITEM",payload:{uid:e,activeItem:t}});var ne=i(438),oe=i(1036);const re=({children:e,customIcon:t,customMessageKey:i})=>c.a.createElement(oe.a.Provider,{value:{customMessageKey:i,customIcon:t}},e);var le=i(600),se=i(1770),de=i.n(se);const ce=({item:e,isActive:t,child:i,alignment:a,maxWidth:n,title:o,caption:r,imageOptions:l,isViewMode:s,isEnlargementPossible:c,containerWidth:p,height:m})=>{var u;return d.createElement("div",{className:de.a.layer,"aria-hidden":!t,style:t||e.mediaobject?void 0:{width:n,height:m},key:e.uid},d.createElement(re,{customMessageKey:"plugin.layeredImage.placeholder",customIcon:le.a.LAYEREDIMAGEMEDIAASSET},d.createElement(ne.a,{uid:e.uid,mediaobject:e.mediaobject,align:a,maxWidth:n,title:o,caption:r,imageOptions:l,isViewMode:s,isEnlargementPossible:c,containerWidth:p||(null===(u=e.mediaobject)||void 0===u?void 0:u.width)||0,children:null===i||void 0===i?void 0:i.props.children})))};var pe=i(495),me=i(3),ue=i(15),he=i(50),ve=i(198),ge=i(437),be=i(51),Ie=i(1844),ye=i.n(Ie);const Oe=Object(p.b)((e,t)=>({tooltipContent:V(e,t)}),(e,t)=>({layeredImageActivateNextItem:()=>e(ie(t.uid))}))(Object(me.injectIntl)(({showIcon:e=!0,activeLayerIndex:t,imageWidth:i,hoverTriggerElement:a,tooltipContent:n,layeredImageActivateNextItem:o,showTooltipOnCreation:r,isInteractionComplete:l,intl:s})=>{const{actionColor:d,visitedActionColor:p,actionTextColor:m}=c.a.useContext(ve.a),[u,h]=c.a.useState(!1),v=c.a.useRef(null),g=c.a.useCallback(()=>{h(!0)},[]),b=c.a.useCallback(()=>{h(!1)},[]);if(!e)return null;const I=n?c.a.createElement(ue.a,{html:n}):s.formatMessage({id:0===t?"plugin.layeredImage.hover.discover-another-view":"plugin.layeredImage.hover.return-to-previous-view"}),y=document.createElement("div");return y.innerHTML="string"===typeof I?I:I.props.html,c.a.createElement("div",{className:ye.a.layerIconWrapper},c.a.createElement(he.a,{key:t,content:I,useDarkColorScheme:!0,positionOutside:!0,placement:"left",hasArrow:!0,triggerTarget:[a,v.current].filter(ge.a),maxWidth:i-95,allowTextWrap:!1,showTooltipOnCreation:r,onTrigger:g,onUntrigger:b,reference:v.current,appendTo:v.current||void 0,offset:[0,15]}),c.a.createElement("div",{"data-is-hovered":u,"data-pulse":!l,"data-active-layer":t,"aria-hidden":!0,className:ye.a.layerIconContent}),c.a.createElement("div",{onClick:e=>{e.stopPropagation(),o()},tabIndex:0,onKeyDown:e=>{"Enter"===e.key&&o()},className:ye.a.layerIcon,"data-is-hovered":u,"data-pulse":!l,style:{backgroundColor:Object(be.a)(l,d,p),outlineColor:Object(be.a)(l,d,p),color:m},role:"button","aria-label":y.innerText,ref:v}))}));var je=i(1845),Ce=i.n(je);const Te=({uid:e,titleOnHover:t,targetType:i,targetTitle:a,showIcon:n,layeredImageWidth:o,alignment:r,onLinkIconClick:l,isTargetReachable:s,isLayeredImageInteractionComplete:c,currentLayerIndex:p,hoverTriggerElement:m,showTooltipOnCreation:u,ariaHidden:h})=>d.createElement("div",{className:Ce.a.layerIconPlacementWrapper,style:{width:o,margin:"center"===r?"0 auto":void 0,left:r&&["left","center"].includes(r)?0:void 0,right:r&&["right","center"].includes(r)?0:void 0,top:0},"aria-hidden":h},i&&n&&d.createElement(pe.a,{uid:e,titleOnHover:t,onClick:l,isDisabled:!s,targetType:i,targetTitle:a,isInteractionComplete:c}),!i&&d.createElement(Oe,{uid:e,showIcon:n,activeLayerIndex:p,imageWidth:o-E.a.small,hoverTriggerElement:m,showTooltipOnCreation:u,isInteractionComplete:c}));class Ee extends c.a.PureComponent{constructor(e){super(e),this.layeredImageWrapper=null,this.resizeSubscription=void 0,this.state={containerWidth:0,showTooltipOnCreation:!1},this.onRefChange=this.onRefChange.bind(this),this.onClick=this.onClick.bind(this)}componentWillUnmount(){var e;null===(e=this.resizeSubscription)||void 0===e||e.unsubscribe()}componentDidUpdate(){!this.state.showTooltipOnCreation&&this.setState({showTooltipOnCreation:!0})}onRefChange(e){this.layeredImageWrapper=e,e&&!this.resizeSubscription&&(this.resizeSubscription=Object(q.a)(e).pipe(Object(J.a)(250),Object(X.a)(e),Object(Y.a)(e=>e.clientWidth)).subscribe(e=>this.setState({containerWidth:e})))}onClick(e){this.props.onLinkClicked&&this.props.onLinkClicked(e)}get isClickable(){return this.props.isEnlargementPossible||!!this.props.onLinkClicked}get dimensions(){var e;return te(this.props.itemsToRender.map(e=>e.mediaobject).filter(Q.a),this.state.containerWidth,this.props.maxWidth,null===(e=this.props.imageOptions)||void 0===e?void 0:e.maskType)}get content(){var e,t;const{isEnlargementPossible:i,isEditorActive:a}=this.props,n=i&&!a?0:this.props.activeLayerIndex,o=this.props.itemsToRender[n],{width:r,height:l,ratio:s}=this.dimensions,d={...this.props.imageOptions,maskType:null!==(e=null===(t=this.props.imageOptions)||void 0===t?void 0:t.maskType)&&void 0!==e?e:s},p=c.a.Children.toArray(this.props.children).filter(F.a),m=0!==this.state.containerWidth?this.state.containerWidth:this.props.maxWidth;return this.props.itemsToRender.map(e=>c.a.createElement(ce,{key:e.uid,item:e,isActive:o.uid===e.uid,child:p.find(t=>t.props.uid===e.uid),alignment:this.props.alignment,maxWidth:r,title:this.props.title,caption:this.props.caption,imageOptions:d,isViewMode:!this.props.editableProps,isEnlargementPossible:i,containerWidth:m,height:l}))}render(){const e=this.props.isEnlarged?void 0:this.props.editableProps,t=c.a.createElement(Te,{key:this.props.uid,uid:this.props.uid,titleOnHover:this.props.titleOnHover,targetType:this.props.targetType,targetTitle:this.props.targetTitle,showIcon:this.props.showIcon,layeredImageWidth:this.dimensions.width,alignment:this.props.alignment,onLinkIconClick:this.isClickable?this.onClick:void 0,isTargetReachable:this.props.isTargetReachable,isLayeredImageInteractionComplete:this.props.isLayeredImageInteractionComplete,currentLayerIndex:this.props.activeLayerIndex,hoverTriggerElement:this.layeredImageWrapper,showTooltipOnCreation:this.state.showTooltipOnCreation,ariaHidden:!1});return c.a.createElement("div",Object.assign({"data-is-selected":this.props.isSelected,"data-is-editable":void 0!==this.props.editableProps,"data-allow-pointer-events":this.props.isSelected||!this.props.editableProps,className:de.a.layeredImageWrapper},e,{ref:this.onRefChange}),c.a.createElement("div",{onClick:this.isClickable?this.onClick:void 0},c.a.createElement("div",{className:de.a.layeredImageContent},1===this.props.activeLayerIndex&&t,this.content,0===this.props.activeLayerIndex&&t)))}}const we=Object($.a)({shouldMarkInteractionComplete:!1,defaultOnLinkClickedAction:ie})(Ee);var fe=i(314),Se=i(57);const ke=Object(m.a)()(Object(p.b)((e,t)=>{var i,a;return{showIcon:B(e,t),itemsToRender:N(e,t),activeLayerIndex:D(e,t),maxWidth:null===y||void 0===y||null===(i=y.maxWidth)||void 0===i?void 0:i.selectors.getMaxWidth(e,t),alignment:_(e,t),title:R(e,t),caption:M(e,t),imageOptions:null===y||void 0===y||null===(a=y.imageOptions)||void 0===a?void 0:a.selectors.getImageOptions(e,t),isEnlargementPossible:K(e,t),isEnlarged:Object(u.e)(e,t),isSelected:Object(fe.a)(e,t),isEditorActive:Object(Se.a)(e),isLayeredImageInteractionComplete:G(e,t)}})(({uid:e,showIcon:t,itemsToRender:i,editableProps:a,activeLayerIndex:n,maxWidth:o,alignment:r,title:l,caption:s,imageOptions:c,isEnlargementPossible:p,isEnlarged:m,isSelected:u,isEditorActive:h,isLayeredImageInteractionComplete:v,children:g})=>d.createElement(we,{uid:e,showIcon:t,itemsToRender:i,activeLayerIndex:n,editableProps:a,maxWidth:o,alignment:r,title:l,caption:s,imageOptions:c,isEnlargementPossible:p,isEnlarged:m,isSelected:u,isEditorActive:h,isLayeredImageInteractionComplete:v,children:g})));var xe=i(471),We=i(944),Ae=i(1846),Pe=i.n(Ae);const Le=Object(m.a)()(Object(p.b)((e,t)=>{var i,a,n,o;return{activeLayerIndex:D(e,t),activeMediaObject:null===(i=N(e,t)[D(e,t)])||void 0===i?void 0:i.mediaobject,itemsToRender:N(e,t),title:null===y||void 0===y||null===(a=y.titleAndCaption)||void 0===a?void 0:a.selectors.getTitle(e,t),caption:null===y||void 0===y||null===(n=y.titleAndCaption)||void 0===n?void 0:n.selectors.getCaption(e,t),imageOptions:null===y||void 0===y||null===(o=y.imageOptions)||void 0===o?void 0:o.selectors.getImageOptions(e,t),isLayeredImageInteractionComplete:G(e,t)}},(e,t)=>({layeredImageActivateNextItem:()=>e(ie(t.uid))}))(({uid:e,activeLayerIndex:t,activeMediaObject:i,title:a,caption:n,layeredImageActivateNextItem:o,imageOptions:r,itemsToRender:l,children:s,editableProps:c,includeSpaceToTop:p,isLayeredImageInteractionComplete:m})=>{var u;const[h,v]=d.useState(!1),[g,b]=d.useState({width:0,height:0}),[I,O]=d.useState(null),j=Object(We.a)(t);d.useEffect(()=>{void 0!==j&&v(!0)},[t,j]);const C=d.useCallback(e=>{e.stopPropagation(),o(),v(!0)},[o]),T=null===(u=y.enlargementWithAdditionalContent)||void 0===u?void 0:u.components.EnlargementWithAdditionalContent;if(!(null===i||void 0===i?void 0:i.width)||!(null===i||void 0===i?void 0:i.height)||!T)return null;const{width:w,ratio:f}=te(l.map(e=>e.mediaobject).filter(Q.a),g.width,void 0,void 0,g.height),S=d.Children.toArray(s).filter(F.a),k=l.map((e,i)=>{var o,l;if((null===(o=e.mediaobject)||void 0===o?void 0:o.height)&&e.mediaobject.width)return d.createElement("div",{className:Pe.a.renderedItemContainer,"data-is-hidden":i!==t,key:e.uid},d.createElement(xe.a,{uid:e.uid,src:e.mediaobject.src,srcSet:e.mediaobject.srcSet,preview:e.mediaobject.preview,height:e.mediaobject.height*(w/e.mediaobject.width),width:w,title:a,caption:n,imageOptions:{...r,maskType:f},onClick:C,children:i===t?null===(l=S.find(t=>t.props.uid===e.uid))||void 0===l?void 0:l.props.children:void 0,forceIsLoaded:i>0}))}).filter(Q.a);return d.createElement(T,{uid:e,setAvailableMediumDimensions:b,editableProps:c,includeSpaceToTop:p,setTooltipHoverRef:O,footerIsHideable:!1,image:k,icon:d.createElement("div",{className:Pe.a.layerIconWrapper},d.createElement(Oe,{uid:e,activeLayerIndex:t,imageWidth:w-E.a.small,hoverTriggerElement:I,showTooltipOnCreation:h,isInteractionComplete:m}))},s)}));var Me=i(1097),Re=i(1577),_e=i(888),Ne=i(1715),De=i(1710),He=i(1704),Ve=i(23),ze=i(14);var Be=i(157);const Ke=[...[(e,t)=>e.pipe(Object(Me.a)("@@layeredImage/ACTIVATE_NEXT_ITEM"),Object(Y.a)(({payload:e})=>e.uid),Object(Re.a)(Q.a),Object(Y.a)(e=>ae(e,H(t.value,{uid:e})))),(e,t)=>e.pipe(Object(Me.a)("@@layeredImage/SET_ACTIVE_ITEM"),Object(Y.a)(({payload:e})=>{if(N(t.value,e).length===U(t.value,e)&&!G(t.value,e))return Object(Ve.o)(T.b,e.uid)}),Object(Re.a)(Q.a)),(e,t)=>e.pipe(Object(Me.a)(Be.d,Be.a),Object(Y.a)(()=>Object(u.a)(t.value)),Object(_e.b)(t=>e.pipe(Object(Me.a)(Be.a),Object(Ne.a)(1),Object(De.a)(e.ofType(Be.d)),Object(He.a)(()=>Object(E.b)(t)?[ae(t.uid,0)]:[]))))],((...e)=>(t,i)=>t.pipe(Object(Me.a)(...e),Object(_e.b)(()=>Object.values(S(i.value)).filter(e=>0!==e.activeItem).map(e=>e.uid).filter(e=>{const t=Z(i.value,{uid:e});return!!t&&[ze.a.ImageEnlargementWithAdditionalContent,ze.a.ImageEnlargement].includes(t)}).map(e=>ae(e,0)))))(Be.b)],Ue={interactionComplete:!1,activeItem:0,visitedItems:[0]},Ge={...T.a,category:a.c.BASIC,includeInProgressTrackingByDefault:()=>!0,isScrollTarget:!0,includeSpaceToTop:!0,canConceal:!0,viewReducer:(e,t)=>{switch(t.type){case"@@layeredImage/SET_ACTIVE_ITEM":{const{payload:i}=t;let a=e[i.uid].visitedItems;return e[i.uid].visitedItems.includes(i.activeItem)||(a=[...a,i.activeItem]),{...e,[i.uid]:{...e[i.uid],activeItem:i.activeItem,visitedItems:a}}}default:return e}},epics:Ke,viewParams:{initialViewParams:()=>Ue,suspendDataViewParams:e=>({...e.interactionComplete&&{interactionComplete:e.interactionComplete},...0!==e.activeItem&&{activeItem:e.activeItem},...e.visitedItems.length>1&&{visitedItems:e.visitedItems}}),reducedSuspendDataViewParams:()=>({}),minifyMap:()=>({activeItem:{key:"a",valueDataType:a.a.Number},interactionComplete:{key:"b",valueDataType:a.a.Boolean},visitedItems:{key:"c",valueDataType:a.a.Array}})},isInteractive:!0,renderer:ke,enlargedMediumRenderer:Le,loadDependencies:()=>Promise.all([Object(s.a)(),Object(l.a)(),Object(n.b)(),Object(o.a)(),Object(r.a)(),Object(W.b)()]).then(([e,t,i,a,d,c])=>(y.titleAndCaption=e,y.mediumAlignment=t,y.enlargementWithAdditionalContent=i,y.imageOptions=a,y.maxWidth=d,y.altText=c,{loadedChunks:[s.b,l.b,n.a,o.b,r.b,W.a]}))}},2032:function(e,t,i){"use strict";i.r(t),i.d(t,"layeredImage",(function(){return a}));const a=i(1978).layeredImagePlugin}}]);
//# sourceMappingURL=https://sourcemaps.intern.chemmedia.de/rre-view-openKnowledgeworker/23.7.5296/layeredImage.7b39bcf2.chunk.js.map