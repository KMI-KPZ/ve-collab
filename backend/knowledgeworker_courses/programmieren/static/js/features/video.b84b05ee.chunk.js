(this["webpackJsonprre-openKnowledgeworker"]=this["webpackJsonprre-openKnowledgeworker"]||[]).push([[20],{1859:function(e,t){},1873:function(e,t){},1894:function(e,t,i){e.exports={chapter:"VL2hMJwxVaoLaUT5VYVAt",playProgress:"_1u27m9v1C8FjfGV8ebKize"}},1895:function(e,t,i){e.exports={video:"_2VfMr6fAIq4cTQrM8tLOCd","video-js":"_3lSUrXUiXVSgbjJAzM9wvP",loader:"_3aiaddUXYgUKF42KDkpPaI",placeholder:"r1fLHC6SQBFf5nklvzaAn",playButton:"_3gp5nCzEsmKiSNJktI1TEM",interruption:"_35zY63O-m2JkBwAtAuBR4j"}},1896:function(e,t){e.exports="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAAAAAAALAAAAAABAAEAQAICRAEAOw=="},1897:function(e,t,i){var o={"./ar.json":[1920,199],"./ba.json":[1921,200],"./bg.json":[1922,211],"./ca.json":[1923,222],"./cs.json":[1924,233],"./cy.json":[1925,242],"./da.json":[1926,243],"./de.json":[1927,244],"./el.json":[1928,245],"./en.json":[1929,246],"./es.json":[1930,201],"./et.json":[1931,202],"./eu.json":[1932,203],"./fa.json":[1933,204],"./fi.json":[1934,205],"./fr.json":[1935,206],"./gd.json":[1936,207],"./gl.json":[1937,208],"./he.json":[1938,209],"./hi.json":[1939,210],"./hr.json":[1940,212],"./hu.json":[1941,213],"./it.json":[1942,214],"./ja.json":[1943,215],"./ko.json":[1944,216],"./lv.json":[1945,217],"./nb.json":[1946,218],"./nl.json":[1947,219],"./nn.json":[1948,220],"./oc.json":[1949,221],"./pl.json":[1950,223],"./pt-BR.json":[1951,224],"./pt-PT.json":[1952,225],"./ro.json":[1953,226],"./ru.json":[1954,227],"./sk.json":[1955,228],"./sl.json":[1956,229],"./sr.json":[1957,230],"./sv.json":[1958,231],"./te.json":[1959,232],"./th.json":[1960,234],"./tr.json":[1961,235],"./uk.json":[1962,236],"./vi.json":[1963,237],"./zh-CN.json":[1964,238],"./zh-Hans.json":[1965,239],"./zh-Hant.json":[1966,240],"./zh-TW.json":[1967,241]};function s(e){if(!i.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],s=t[0];return i.e(t[1]).then((function(){return i.t(s,3)}))}s.keys=function(){return Object.keys(o)},s.id=1897,e.exports=s},2059:function(e,t,i){"use strict";i.r(t),i.d(t,"VideoComponent",(function(){return Z}));var o=i(0),s=i(567),r=i(640),n=i(641),a=i(39),d=i(51),l=i(168),h=i(315),p=(i(1856),i(93)),c=i(2),u=i(3),v=i(1772);const m=v.a.getComponent("PlayProgressBar");class g extends m{createEl(){return v.a.dom.createEl("div")}}const b=(e,t)=>({...e,Subtitles:t.formatMessage({id:"plugin.medium.videoplayer.captions"}),"Non-Fullscreen":t.formatMessage({id:"plugin.medium.videoplayer.fullscreen.non"}),Pause:t.formatMessage({id:"plugin.medium.player.pause"}),Play:t.formatMessage({id:"plugin.medium.player.play"}),"The media could not be loaded, either because the server or network failed or because the format is not supported.":t.formatMessage({id:"plugin.medium.videoplayer.loading-failed"}),"subtitles off":t.formatMessage({id:"plugin.medium.videoplayer.captions.off"}),Fullscreen:t.formatMessage({id:"plugin.medium.videoplayer.fullscreen"}),"Playback Rate":t.formatMessage({id:"plugin.medium.videoplayer.playback-rate"}),"Play Video":t.formatMessage({id:"plugin.medium.player.play"}),Replay:t.formatMessage({id:"plugin.medium.player.replay"})});var y=i(1),f=i(5),T=i(1192),N=i(4);const j=Object(y.createSelector)([N.b],e=>null===e||void 0===e?void 0:e.feature),A=Object(y.createSelector)([j],e=>{var t;return!!(null===e||void 0===e||null===(t=e.clipboard)||void 0===t?void 0:t.enabled)}),C=(Object(y.createSelector)([A,f.v,T.a],(e,t,i)=>e&&!i&&!t),Object(y.createSelector)([j],e=>{var t,i;return null===(t=null===e||void 0===e||null===(i=e.chaptersForVideos)||void 0===i?void 0:i.enabled)||void 0===t||t})),P=Object(y.createSelector)([j],e=>{var t,i;return null===(t=null===e||void 0===e||null===(i=e.aiTextCreation)||void 0===i?void 0:i.enabled)||void 0===t||t}),S=Object(y.createSelector)([j],e=>{var t,i;return null===(t=null===e||void 0===e||null===(i=e.aiImageCreation)||void 0===i?void 0:i.enabled)||void 0===t||t}),O=(Object(y.createSelector)([P,S],(e,t)=>e||t),e=>{const t=new Date(1e3*e).toISOString().match(/T(\d{2}:\d{2}:\d{2}.\d{3})Z/);if(t)return t[1]});var k=i(19),x=i(142),w=i(57),E=i(349),B=i(167);const L=Object(y.createSelector)([k.r,w.a,E.b],(e,t,i)=>!(!e||t)&&i),R=Object(y.createSelector)([k.r,w.a,E.b],(e,t,i)=>!(!e||t)&&i),V=Object(y.createSelector)([B.c,C],(e,t)=>{var i,o,s;if(t)return(null===e||void 0===e||null===(i=e.videoOptions)||void 0===i||null===(o=i.chapters)||void 0===o?void 0:o.length)?e.videoOptions.chapters[0].time>1e-6?[{time:1e-6,ref:Object(x.a)(8),title:void 0},...e.videoOptions.chapters]:null===e||void 0===e||null===(s=e.videoOptions)||void 0===s?void 0:s.chapters:[{time:1e-6,ref:Object(x.a)(8),title:void 0}]}),D=Object(y.createSelector)([V],e=>{if(!e)return[{start:1e-6,end:void 0,title:void 0,ref:Object(x.a)(8)}];const t=e.map(({time:t,title:i,ref:o},s)=>({start:t,end:s===e.length-1?void 0:e[s+1].time,title:null===i||void 0===i?void 0:i.html,ref:o}));return t[0].start>1e-6&&t.unshift({start:1e-6,end:t[0].start,title:void 0,ref:Object(x.a)(8)}),t}),H=Object(y.createSelector)([V,D],(e,t)=>{if(null===e||void 0===e?void 0:e.length)return"WEBVTT\n\n"+t.filter(e=>!!e.title).map(e=>{var t;return`${O(e.start)} --\x3e ${O(null!==(t=e.end)&&void 0!==t?t:86399)}\n${e.title}`}).join("\n\n")});var M=i(69),I=i(411),F=i(169),U=i(157),K=i(50),_=i(1894),z=i.n(_);const W=({start:e,end:t,videoDuration:i,isFirstChapter:s,isLastChapter:r,currentTimeSubject:n,title:a,videoNodeRef:d})=>{const l=(e/i*100).toFixed(4)+"%",h=(((null!==t&&void 0!==t?t:i)-e)/i*100).toFixed(4)+"%",[p,c]=o.useState(0),u=o.useRef(),[v,m]=o.useState(null);if(o.useEffect(()=>(u.current=n.subscribe(c),()=>{var e;null===(e=u.current)||void 0===e||e.unsubscribe()}),[n]),isNaN(i))return null;let g;return g=p<=e?0:p>=(null!==t&&void 0!==t?t:i)?1:(p-e)/((null!==t&&void 0!==t?t:i)-e),o.createElement(K.a,{content:a,appendTo:"parent",useDarkColorScheme:!0,placement:"top",offset:[0,9],followCursor:!1,allowTextWrap:!1,reference:v,maxWidth:d?d.clientWidth-50:void 0,popperOptions:d?{modifiers:[{name:"preventOverflow",options:{mainAxis:!0,boundary:d,padding:{left:12,right:12}}}]}:void 0},o.createElement("div",{className:z.a.chapter,ref:m,style:{left:s?l:`calc(${l} + 1.5px)`,width:r?h:`calc(${h} - ${s||r?1.5:3}px)`},"data-is-chapter":!!a,"data-use-transition":g>0&&g<1},o.createElement("div",{className:z.a.playProgress,style:{width:(100*g).toFixed(6)+"%"},"data-test-id":F.a.VIDEO_CHAPTER_PLAY_PROGRESS})))},{isWindows:q}=i(834),$=q;var J=i(1895),Q=i.n(J),Y=i(1032);const G={playbackRates:[.5,1,1.5,2]},X=i(1896);class Z extends o.PureComponent{constructor(e){super(e),this.videoNode=void 0,this.videoDivNode=void 0,this.interruptionsNode=void 0,this.chaptersNode=void 0,this.audioHintNode=void 0,this.player=null,this.lastTime=void 0,this.reachedTime=void 0,this.videoDivNodeResizeSubscription=void 0,this.bigPlayButton=null,this.audioHintMeasuringSpan=null,this.currentTimeSubject=new s.a,this.state={imageIsLoaded:!!this.props.thumbSrc,videoIsLoaded:!1,playerIsLoaded:!1,showAudioHint:!0},this.videoDivNode=null,this.videoNode=null,this.lastTime=-1,this.reachedTime=0,this.onLoadImage=this.onLoadImage.bind(this),this.onLoadVideo=this.onLoadVideo.bind(this),this.onPlay=this.onPlay.bind(this),this.onEnded=this.onEnded.bind(this),this.onVideoDivNodeRefChange=this.onVideoDivNodeRefChange.bind(this),this.onVideoNodeRefChange=this.onVideoNodeRefChange.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onSeeking=this.onSeeking.bind(this),this.updatePlayer=this.updatePlayer.bind(this),this.handleBackgroundAutoPlay=this.handleBackgroundAutoPlay.bind(this),this.stopPropagation=this.stopPropagation.bind(this),this.onArrowLeftOrRightKeyPress=this.onArrowLeftOrRightKeyPress.bind(this)}componentDidMount(){const e=this.props.locale?this.props.locale.substring(0,2):"";i(1897)(`./${e}.json`).then(t=>{const i=b(t,this.props.intl),o={[e]:i};v.a.registerComponent("PlayProgressBar",g),this.videoNode&&(this.player=Object(v.a)(this.videoNode,{...G,languages:o,language:e},()=>this.setState({playerIsLoaded:!0})),this.updatePlayer())}).catch(()=>{const t=b({},this.props.intl),i={[e]:t};v.a.registerComponent("PlayProgressBar",g),this.videoNode&&(this.player=Object(v.a)(this.videoNode,{...G,languages:i,language:e},()=>this.setState({playerIsLoaded:!0})),this.updatePlayer())}),this.videoNode&&this.videoNode.addEventListener("contextmenu",this.onContextMenu)}updatePlayer(){var e,t;null!==this.player&&(this.chaptersNode=document.createElement("div"),null===(e=this.player.el().querySelector(".vjs-progress-holder"))||void 0===e||e.appendChild(this.chaptersNode),this.interruptionsNode=document.createElement("div"),null===(t=this.player.el().querySelector(".vjs-progress-holder"))||void 0===t||t.appendChild(this.interruptionsNode),this.audioHintNode=document.createElement("div"),this.audioHintNode.setAttribute("class","audioHint"),this.player.el().insertBefore(this.audioHintNode,this.player.el().querySelector(".vjs-control-bar")),this.audioHintMeasuringSpan=this.videoDivNode?this.videoDivNode.querySelector('.audioHint[data-is-for-measuring="true"] span'):null,this.player.on("ready",()=>{this.props.chaptersVTTText&&this.onAddChaptersTextTrack(this.props.chaptersVTTText)}))}componentWillUnmount(){var e,t,i;null===(e=this.player)||void 0===e||e.dispose(),null===(t=this.videoNode)||void 0===t||t.removeEventListener("contextmenu",this.onContextMenu),null===(i=this.videoDivNodeResizeSubscription)||void 0===i||i.unsubscribe()}componentDidUpdate(e){var t,i;(this.props.src!==e.src&&this.setState({videoIsLoaded:!1}),this.props.isFastForwardDisabled!==e.isFastForwardDisabled)&&(this.props.isFastForwardDisabled?null===(t=this.player)||void 0===t||t.controlBar.playbackRateMenuButton.hide():null===(i=this.player)||void 0===i||i.controlBar.playbackRateMenuButton.show());this.videoNode&&(!this.props.isActive&&e.isActive||this.props.isInHiddenElement&&!e.isInHiddenElement)&&this.videoNode.pause(),this.props.autoPlay!==e.autoPlay&&this.handleBackgroundAutoPlay(),e.videoActionColor===this.props.videoActionColor&&e.actionColor===this.props.actionColor&&e.visitedActionColor===this.props.visitedActionColor&&e.isInteractionComplete===this.props.isInteractionComplete||this.setVideoActionColorCSSVar(),this.props.chaptersVTTText&&this.props.chaptersVTTText!==e.chaptersVTTText&&this.player&&this.onAddChaptersTextTrack(this.props.chaptersVTTText),e.chaptersVTTText&&!this.props.chaptersVTTText&&this.player&&this.onRemoveChaptersTextTrack()}onAddChaptersTextTrack(e){var t,i;(null===(t=this.player)||void 0===t?void 0:t.tech(!0))&&(this.onRemoveChaptersTextTrack(),this.player.addRemoteTextTrack({src:"data:text/txt;base64,"+btoa(e),kind:"chapters",tech:this.player.tech(!0),default:!0,srclang:null===(i=this.props.locale)||void 0===i?void 0:i.substring(0,2)},!1))}onRemoveChaptersTextTrack(){if(!this.player)return;const e=this.player.remoteTextTracks(),t=e.length;for(let i=0;i<t;i++)"chapters"===e[i].kind&&this.player.removeRemoteTextTrack(e[i])}stopPropagation(e){e.stopPropagation()}onContextMenu(e){e.preventDefault()}onPlay(){var e;(this.onTimeUpdate(),this.props.onPlay&&this.props.onPlay(),this.props.isFastForwardDisabled)&&(null===(e=this.player)||void 0===e||e.controlBar.playbackRateMenuButton.hide())}onTimeUpdate(){if(!this.videoNode)return;if(!this.videoNode.seeking&&this.props.isSeekingForwardDisabled&&(this.reachedTime=this.reachedTime<this.videoNode.currentTime?this.videoNode.currentTime:this.reachedTime),this.currentTimeSubject.next(this.videoNode.currentTime),!this.props.interruptions||!this.props.interruptions.length||this.lastTime===this.videoNode.currentTime)return;const e=this.props.interruptions.find(e=>!!this.videoNode&&e.time>this.lastTime&&e.time<=this.videoNode.currentTime);if(this.lastTime=this.videoNode.currentTime,e&&(!this.videoNode.paused||this.videoNode.ended))return this.videoNode.pause(),this.videoNode.setAttribute("paused-by-interruption","true"),this.player&&this.player.isFullscreen()&&this.player.exitFullscreen(),void this.props.showPopup(e.ref);window.requestAnimationFrame(this.onTimeUpdate)}onSeeking(){const e=this.videoNode;e&&this.props.isSeekingForwardDisabled&&e.currentTime>this.reachedTime&&(e.currentTime=this.reachedTime)}onLoadImage(){this.setState({imageIsLoaded:!0})}onLoadVideo(){this.setState({videoIsLoaded:!0}),this.props.onLoad&&this.props.onLoad()}onEnded(){this.props.onInteractionComplete&&this.props.onInteractionComplete()}onVideoDivNodeRefChange(e){this.videoDivNode=e,this.setVideoActionColorCSSVar(),e&&this.props.videoAudioHint&&(this.videoDivNodeResizeSubscription||(this.videoDivNodeResizeSubscription=Object(a.a)(e).pipe(Object(r.a)(e),Object(n.a)(100)).subscribe(()=>{this.onAudioHintOverlapsBigPlayButtonChange()})),this.observeAdditionOfBigPlayButton(e))}onVideoNodeRefChange(e){this.videoNode=e}onArrowLeftOrRightKeyPress(e){if(this.videoNode&&!this.props.isSeekingForwardDisabled){const o=this.videoNode.currentTime,s=$?"ctrlKey":"altKey";if("ArrowRight"===e.key&&e[s]){var t;const e=this.props.chapters.find(e=>e.start>o);return void(this.videoNode.currentTime=null!==(t=null===e||void 0===e?void 0:e.start)&&void 0!==t?t:o)}if("ArrowLeft"===e.key&&e[s]){var i;const e=[...this.props.chapters].reverse().find(e=>e.start<o-3);return void(this.videoNode.currentTime=null!==(i=null===e||void 0===e?void 0:e.start)&&void 0!==i?i:o)}"ArrowLeft"===e.key&&(this.videoNode.currentTime-=5),"ArrowRight"===e.key&&(this.videoNode.currentTime+=5)}}observeAdditionOfBigPlayButton(e){new MutationObserver((t,i)=>{t.find(e=>Array.from(e.addedNodes).find(e=>"vjs-big-play-button"===e.className))&&(i.disconnect(),this.bigPlayButton=e.querySelector(".vjs-icon-placeholder"),this.onAudioHintOverlapsBigPlayButtonChange())}).observe(e,{childList:!0,subtree:!0})}onAudioHintOverlapsBigPlayButtonChange(){this.audioHintMeasuringSpan&&this.bigPlayButton&&this.setState({showAudioHint:this.audioHintMeasuringSpan.getBoundingClientRect().top>=this.bigPlayButton.getBoundingClientRect().bottom+5})}handleBackgroundAutoPlay(){this.props.isBackground&&this.videoNode&&(this.props.autoPlay&&this.videoNode.paused&&setTimeout(()=>this.videoNode&&this.videoNode.play(),1),!this.props.autoPlay&&this.videoNode.currentTime>0&&!this.videoNode.paused&&this.videoNode.pause())}setVideoActionColorCSSVar(){var e,t,i;this.videoDivNode&&Object(I.a)({rootElement:this.videoDivNode,silent:!0,variables:{"video-action-color":Object(d.a)(null!==(e=this.props.isInteractionComplete)&&void 0!==e&&e,null!==(t=this.props.actionColor)&&void 0!==t?t:this.props.videoActionColor,this.props.visitedActionColor),"color-set-action-text-color":null!==(i=this.props.actionTextColor)&&void 0!==i?i:this.props.videoActionTextColor,...this.props.actionHoverColor?{"--action-hover-color":this.props.actionHoverColor}:{},...this.props.actionHoverColor&&this.props.actionTextColor?{"--action-text-color":this.props.actionTextColor}:{}}})}get showPlaceholder(){return!(this.state.videoIsLoaded&&this.state.playerIsLoaded||this.props.thumbSrc)}get placeholder(){if(!this.showPlaceholder)return null;const e=o.createElement("img",{key:"placeholder",className:Q.a.placeholder,onLoad:this.onLoadImage,src:X,alt:""});return this.props.autoPlay?e:[e,o.createElement("div",{key:"playButton",className:Q.a.playButton})]}get vttFile(){const{attachments:e}=this.props;if(!e||0===e.length)return;const t=e[0];return o.createElement("track",{kind:"subtitles",label:this.props.intl.formatMessage({id:"plugin.medium.videoplayer.captions.on"}),default:this.props.hasActivatedSubtitle,src:t&&t.src})}get interruptions(){const{interruptions:e}=this.props;if(!e||0===e.length||!this.interruptionsNode||!this.videoNode)return;const{duration:t}=this.videoNode;return p.createPortal(o.createElement(o.Fragment,null,e.map(e=>o.createElement("div",{key:e.ref,className:Q.a.interruption,style:{left:e.time/t*100+"%"},"data-test-id":F.a.VIDEO_COMPONENT_INTERRUPTION}))),this.interruptionsNode)}get chapters(){if(!this.chaptersNode||!this.videoNode)return;const{chapters:e}=this.props,{duration:t}=this.videoNode;return p.createPortal(o.createElement(o.Fragment,null,e.map(({ref:i,...s},r)=>o.createElement(W,Object.assign({key:i},s,{videoDuration:t,isFirstChapter:0===r,isLastChapter:r===e.length-1,currentTimeSubject:this.currentTimeSubject,videoNodeRef:this.videoDivNode})))),this.chaptersNode)}get audioHintMessage(){return o.createElement("div",{"data-audio-is-available":this.props.isAudioForVideoAvailable},o.createElement(u.FormattedMessage,{id:this.props.videoAudioHint}))}get audioHint(){if(this.props.videoAudioHint&&this.audioHintNode&&this.videoNode&&this.state.showAudioHint)return p.createPortal(this.audioHintMessage,this.audioHintNode)}render(){return o.createElement(h.a,{width:this.props.width,height:this.props.height,maxWidth:this.props.maxWidth},o.createElement("div",{ref:this.onVideoDivNodeRefChange,className:Q.a.video,"aria-hidden":this.props.isBackground,"data-vjs-player":!0,"data-is-loaded":this.state.imageIsLoaded&&this.state.playerIsLoaded&&!this.showPlaceholder,"data-test-id":F.a.VIDEO_COMPONENT,onClick:this.props.isBackground?void 0:this.stopPropagation},this.props.videoAudioHint&&o.createElement("div",{className:"audioHint","data-is-for-measuring":!0,"aria-hidden":!0},this.audioHintMessage),this.placeholder,this.chapters,this.interruptions,this.audioHint,o.createElement("video",{ref:this.onVideoNodeRefChange,className:"video-js vjs-custom-skin",controls:!1!==this.props.controls,src:this.props.src,onLoadedData:this.onLoadVideo,onPlay:this.onPlay,onEnded:this.onEnded,onTimeUpdate:this.onTimeUpdate,onSeeking:this.onSeeking,autoPlay:!!this.props.autoPlay,poster:this.props.thumbSrc,"data-indentifier":this.props.uid,playsInline:!0,muted:this.props.isMuted,loop:this.props.isLooped,onKeyDown:this.onArrowLeftOrRightKeyPress},o.createElement("source",{src:this.props.src,type:this.props.mimeType}),this.vttFile)))}}t.default=Object(M.a)(Object(c.b)((e,t)=>{const i=Object(k.K)(e),o=t.uid||"";return{locale:Object(l.b)(e),hasActivatedSubtitle:!0,isSeekingForwardDisabled:L(e,{uid:o}),isFastForwardDisabled:R(e,{uid:o}),videoActionColor:i["video-action-color"],videoActionTextColor:i["video-action-text-color"],chapters:D(e,{uid:o}),chaptersVTTText:H(e,{uid:o})}},e=>({showPopup:t=>e(Object(U.h)(t))}))(Object(u.injectIntl)(Object(Y.a)(Z))))}}]);
//# sourceMappingURL=https://sourcemaps.intern.chemmedia.de/rre-view-openKnowledgeworker/23.7.5296/video.b84b05ee.chunk.js.map